{
  // =============================================================================
  // Linux Voice Assistant (LVA) — Configuration Example
  //
  // Notes:
  // - This file uses JSON-with-comments (jsonc). Your editor may support it.
  // - The app loads config via linux_voice_assistant.config.load_config_from_json().
  // - Some behavior can be overridden by CLI flags (e.g., --debug).
  // =============================================================================

  // ---------------------------------------------------------------------------
  // Required
  // ---------------------------------------------------------------------------
  "app": {
    // Required: Friendly name for this LVA instance
    "name": "My Linux Voice Assistant",

    // Optional: Wake word triggered sound (relative to repo root)
    "wakeup_sound": "sounds/wake_word_triggered.flac",

    // Optional: Timer finished sound (relative to repo root)
    "timer_finished_sound": "sounds/timer_finished.flac",

    // Optional: Preferences file used to persist state like volume/num_leds
    // (relative to repo root)
    "preferences_file": "preferences.json",

    // Optional: Enables debug logging by default
    // Note: can also be enabled via CLI flag --debug
    "debug": false
  },

  // ---------------------------------------------------------------------------
  // Optional: Audio I/O + Output Volume Sync
  // ---------------------------------------------------------------------------
  "audio": {
    // Optional:
    // - null/omit => default microphone
    // - string name => exact device name (soundcard backend)
    // - string number => index into soundcard device list (e.g. "0", "1", ...)
    "input_device": null,

    // Optional: audio capture block size
    "input_block_size": 1024,

    // Optional:
    // - null/omit => mpv chooses default output
    // - string => mpv audio-device (e.g. "pulse/alsa_output....")
    "output_device": null,

    // Optional: Sync the host OS output volume at startup to match the volume
    // stored in preferences.json (LVA MediaPlayer volume).
    //
    // When enabled, LVA will attempt (in order): wpctl -> pactl -> amixer.
    //
    // Default: false
    "volume_sync": false,

    // Optional: Maximum output volume percent for the underlying sink.
    //
    // Default: 100
    "max_volume_percent": 100
  },

  // ---------------------------------------------------------------------------
  // Optional: Wake word config
  // ---------------------------------------------------------------------------
  "wake_word": {
    // Optional: If omitted/empty, code falls back to defaults:
    // ["wakewords", "wakewords/openWakeWord"]
    //
    // Paths are relative to repo root.
    "directories": [],

    // Optional: default wake word model id
    "model": "okay_nabu",

    // Optional: stop model id (micro wake word)
    "stop_model": "stop",

    // Optional: debounce/refractory window after wake word triggers
    "refractory_seconds": 2.0,

    // Optional: directory for downloaded models (relative to repo root)
    "download_dir": "local",

    // Optional: OpenWakeWord activation threshold.
    //
    // OpenWakeWord triggers if its model probability exceeds this value.
    // Range: 0.0 - 1.0
    //
    // Default: 0.5 (matches previous hardcoded behavior)
    "openwakeword_threshold": 0.5
  },

  // ---------------------------------------------------------------------------
  // Optional: ESPHome protocol server settings (the LVA exposes an ESPHome API)
  // ---------------------------------------------------------------------------
  "esphome": {
    // Default: "0.0.0.0" (listen on all interfaces)
    "host": "0.0.0.0",

    // Default: 6053
    "port": 6053
  },

  // ---------------------------------------------------------------------------
  // Optional: LEDs
  // ---------------------------------------------------------------------------
  "led": {
    // Optional: if false, LED controller runs in no-op mode
    "enabled": true,

    // "dotstar" | "neopixel" | "xvf3800"
    "led_type": "dotstar",

    // "spi" | "gpio" | "usb"
    // - dotstar: "spi" or "gpio"
    // - neopixel: "spi" or "gpio"
    // - xvf3800: "usb"
    "interface": "spi",

    // GPIO pins — used when interface="gpio"
    // For DotStar GPIO: both clock_pin + data_pin are used
    // For NeoPixel GPIO: only data_pin is used (clock_pin ignored)
    // For XVF3800: unused and ignored
    "clock_pin": 13,
    "data_pin": 12,

    // Default number of LEDs (may be overridden by preferences.json after first run)
    "num_leds": 3
  },

  // ---------------------------------------------------------------------------
  // Optional: MQTT
  //
  // IMPORTANT for Tray Client:
  // - The tray client requires MQTT enabled AND mqtt.host set.
  // - If mqtt.host is null/empty, tray client will refuse to start.
  // ---------------------------------------------------------------------------
  "mqtt": {
    // If set, mqtt.enabled becomes true automatically
    "host": null,

    "port": 1883,
    "username": null,
    "password": null
  },

  // ---------------------------------------------------------------------------
  // Optional: Button controller
  // ---------------------------------------------------------------------------
  "button": {
    // Master enable
    "enabled": false,

    // "gpio" | "xvf3800"
    // - gpio: short/long press logic (pin + long_press_seconds)
    // - xvf3800: uses the XVF3800 built-in mute button as a mute toggle
    "mode": "gpio",

    // gpio mode only
    "pin": 17,
    "long_press_seconds": 1.0,

    // Polling interval (used by both gpio + xvf3800 button controllers)
    "poll_interval_seconds": 0.01
  },

  // ---------------------------------------------------------------------------
  // Optional: Desktop Tray Client
  // ---------------------------------------------------------------------------
  "tray": {
    // The systemd --user unit name the tray client controls (start/stop/restart).
    //
    // The tray client default (if omitted): "linux-voice-assistant.service"
    //
    // If you renamed the LVA unit, set it here so the tray menu controls
    // the correct service.
    "systemd_service_name": "linux-voice-assistant.service"
  },
  
  // ---------------------------------------------------------------------------
  // Optional: Sendspin (Music Assistant "Send to player" / streaming)
  //
  // Enables this LVA instance to appear as a player in Music Assistant via
  // the Sendspin server, accept PCM streams, play them via mpv, and support:
  // - mDNS discovery (_sendspin-server._tcp.local.) OR explicit host/port
  // - volume/mute control from MA (independent from LVA's normal volume)
  // - ducking on LVA voice events (wake word / listening / responding)
  //
  // The last Sendspin volume is persisted in preferences.json (sendspin_volume).
  // ---------------------------------------------------------------------------
  "sendspin": {
    // Master enable for the Sendspin subsystem
    "enabled": false,
    // -----------------------------------------------------------------------
    // Coordination sendspin audio duck during voice events
    // -----------------------------------------------------------------------
    "coordination": { 
      "duck_during_voice": true },
    // -----------------------------------------------------------------------
    // Connection / discovery
    // -----------------------------------------------------------------------
    "connection": {
      // If true, discover MA Sendspin server via mDNS.
      // If false, you must set server_host (and optionally port/path).
      "mdns": true,

      // Optional: override discovery and connect directly:
      // - server_host: IP or hostname of Music Assistant host
      // - server_port: default 8927
      // - server_path: default "/sendspin"
      "server_host": null,
      "server_port": 8927,
      "server_path": "/sendspin",

      // Websocket connection behavior
      "timeout_seconds": 6.0,
      "hello_timeout_seconds": 8.0,

      // Websocket keepalive ping (handled by websockets library)
      "ping_interval_seconds": 20.0,
      "ping_timeout_seconds": 20.0,

      // Periodic Sendspin messages
      // client/time interval (microseconds monotonic time domain)
      "time_sync_interval_seconds": 5.0,

      // client/state heartbeat interval (keeps presence online)
      "state_heartbeat_seconds": 5.0
    },

    // -----------------------------------------------------------------------
    // Roles advertised to the server
    // -----------------------------------------------------------------------
    "roles": {
      // Minimum recommended:
      "player": true,
      "controller": true,
      "metadata": true,

      // Optional (not currently implemented in LVA Sendspin client):
      "artwork": false,
      "visualizer": false
    },

    // -----------------------------------------------------------------------
    // Player / streaming settings
    // -----------------------------------------------------------------------
    "player": {
      // Advertised support (and expected stream format from MA)
      "sample_rate": 48000,
      "channels": 2,
      "bit_depth": 16,

      // Buffer capacity advertised to MA (bytes)
      "buffer_capacity_bytes": 1048576,

      // Optional: force mpv audio backend/device for Sendspin playback only.
      // If null/omit, mpv chooses automatically.
      //
      // Examples:
      //   "mpv_ao": "pipewire"
      //   "mpv_audio_device": "pipewire/alsa_output.platform-fe00b840.mailbox.stereo-fallback"
      "mpv_ao": null,
      "mpv_audio_device": null,

      // Optional: ducking behavior when LVA begins listening/responding.
      // If enabled, Sendspin playback volume is reduced temporarily.
      "ducking": {
        "enabled": true,

        // Volume percent to duck to (0-100)
        "duck_volume_percent": 20,

        // If true, also duck on voice_wake / voice_listen events.
        // (Exact events depend on what your Sendspin client subscribes to.)
        "duck_on_voice_events": true
      }
    }

  // ---------------------------------------------------------------------------
  // Back-compat note (optional)
  // ---------------------------------------------------------------------------
  // Historically, some setups used a top-level "volume_sync".
  // If your loader supports it, it typically maps to audio.volume_sync.
  //
  // "volume_sync": false
}
